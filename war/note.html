<html>
    <head>
        <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
        <title>
            LAN-Gymnasium online Klassenbuch
        </title>
         <link rel="stylesheet" href="style/webpage.css" type="text/css">
    </head>
    <body>
	<script src="javascript/script.js"></script>
	<script src="javascript/jquery-2.1.4.min.js"></script>
	<script>
		var user;
		var userSchool;
		var footerEventCount;
		
		window.addEventListener("OnFooterLoaded", function(e) {
			if(footerEventCount >= 1){ 
				$('#footer_txt_logininfo').prepend(document.createTextNode('Angemeldet im ' + userSchool.name + ' als '));
				
				$('#footer_txt_logininfo').append(document.createTextNode(user.firstName + ' ' + user.familyName));
			}
			else{
				footerEventCount++;
			}
		})
		
		window.addEventListener("DOMContentLoaded", function(){
			$.getJSON("/rest/user/loggedInUser", function(user) {
				setUser(user);
			})
			
			$.getJSON("/rest/user/userSchool", function(school) {
				setUserSchool(school);
				var evt = new CustomEvent("OnFooterLoaded", {});
				window.dispatchEvent(evt);
			})
		});
		
		function setUser(user){
			this.user = user;
		}
		
		function setUserSchool(school){
			this.userSchool = school;
		}
		
	</script>
		<header>
			<nav id="doc_navlist">
				<ul>
					<li> </li>
					<li>
						<a href="./mylan.html">MyLAN</a>
					</li> 
					<li>
						<a href="./teachers.html">Lehrer</a>
					</li> 
					<li>
						<a href="./classes.html">Klassen</a>
					</li> 
					<li>
						<a href="./pupils.html">Sch&uuml;ler</a>
					</li>
					<li>
						<a href="./maint.html">Verwalten</a>
					</li>

					<li id="current">
						<a href="./note.html">Notiz</a>
					</li>
					<li> </li>
					<li id="justifier"> </li>
				</ul>
			</nav>
		</header>
		
		
		<div id="pagecontent">
			<form>
				<div id="note_inpt_metadata">
					<span>
						<label for="teacher">Lehrer:</label>
						<input type="text" name="teacher" value="" id="note_inpt_tName" readonly>
					</span>
					<span>
						<label for="timestamp">Erfassungszeitpunkt:</label>
						<input type="text" name="timestamp" value="" id="note_inpt_ts" readonly>
					</span>
					<span>
						<label for="pupil">Sch&uumller: </label>
						<input type="text" name="pupil" value="" id="note_inpt_pName" readonly>
					</span>
					<div id="note_btn_sla">
						<input type="button" value="Abbrechen" id="login_bt" onclick="onclickReturnToPupils()"/>
						<input type="button" value="Speichern" id="login_bt" onclick="onclickSaveNote(this.form)"/>
					</div>
				</div>
			
				<div id="note_content">
					<textarea id="note_txtArea_content"></textarea>
				</div>
			</form>
		</div>
		
		<footer>
			<div id="footer_logoutbar">
				<p id="footer_txt_logininfo"></p>
				<a href='logout' id="footer_a_logout">> Abmelden &lt;</a>
			</div>
		</footer>
    </body>
</html>