<html>
    <head>
        <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
        <title>
            LAN-Gymnasium online Klassenbuch
        </title>
         <link rel="stylesheet" href="style/webpage.css" type="text/css">
    </head>
    <body>
		<script src="javascript/script.js"></script>
		<script src="javascript/jquery-2.1.4.min.js"></script>
	<script>
		window.addEventListener("DOMContentLoaded", function(){
			getUser();
			getAllSchools();
			getAllGrades();
			getAllLetters();
			getAllPupils();
			filter();
		});
		
		function getUser(){
		
		
			$.getJSON("/rest/user/userSchool", function(school) {
				$('#footer_txt_logininfo').prepend(document.createTextNode('Angemeldet im ' + school.name + ' als '));
			})
			$.getJSON("/rest/user/loggedInUser", function(user) {
				$('#footer_txt_logininfo').append(document.createTextNode(user.firstName + ' ' + user.familyName));
			})
		}
		
			function appendSchool(school){
				$('#ddb_inst').append($('<option value=\"'+ school.key.id +'\">'+ school.name +'</option>'));
			}
		
			function getAllSchools(){
				$.getJSON("/rest/school", function(data) {
					$("#ddb_inst option").remove();
					$('#ddb_inst').append($('<option value="null" selected id="teachers_ddbFilter_inst">Nach Schule filtern</option>'));
					$.each(data, function(index, school) {
						appendSchool(school);
					})
				})
			}
			
			function appendGrade(grade){
				$('#ddb_grade').append($('<option value=\"'+ grade +'\">'+ grade +'</option>'));
			}
		
			function getAllGrades(){
				$.getJSON("/rest/clazz/grades", function(data) {
					$("#ddb_grade option").remove();
					$('#ddb_grade').append($('<option value="0" selected id="teachers_ddbFilter_grade">Nach Stufe filtern</option>'));
					$.each(data, function(index, grade) {
						appendGrade(grade);
					})
				})
			}
			
			function appendLetters(letter){
				$('#ddb_class').append($('<option value=\"'+ letter +'\">'+ letter +'</option>'));
			}
		
			function getAllLetters(){
				$.getJSON("/rest/clazz/letters", function(data) {
					$("#ddb_class option").remove();
					$('#ddb_class').append($('<option value="null" selected id="teachers_ddbFilter_class">Nach Klasse filtern</option>'));
					$.each(data, function(index, letter) {
						appendLetters(letter);
					})
				})
			}
			
			function appendPupil(pupil){
				$('#ddb_pupil').append($('<option value=\"'+ pupil.key.id +'\">'+ pupil.firstName + ' ' +pupil.familyName +'</option>'));
			}
		
			function getAllPupils(){
				$.getJSON("/rest/user/pupils", function(data) {
					$("#ddb_pupil option").remove();
					$('#ddb_pupil').append($('<option value="null" selected id="teachers_ddbFilter_pupil">Nach Schueler filtern</option>'));
					$.each(data, function(index, pupil) {
						appendPupil(pupil);
					})
				})
			}
			
			function filter(){
				var schoolSelect = document.getElementById('ddb_inst');
				var gradeSelect = document.getElementById('ddb_grade');
				var letterSelect = document.getElementById('ddb_class');
				var pupilSelect = document.getElementById('ddb_pupil');
				
				var filterSchool = schoolSelect.options[schoolSelect.selectedIndex].value;
				var filterGrade = gradeSelect.options[gradeSelect.selectedIndex].value;
				var filterLetter = letterSelect.options[letterSelect.selectedIndex].value;
				var filterPupil = pupilSelect.options[pupilSelect.selectedIndex].value;
				
				var filterObject = {schoolID:filterSchool, grade:filterGrade, letter:filterLetter, teacherID:null, studentID:filterPupil};
				
				$.ajaxSetup({
					  contentType: "application/json; charset=utf-8"
				});
				$.ajax({
					url: "/rest/filter/teachers",
					contentType: "application/json; charset=utf-8",
					data: JSON.stringify(filterObject),
					success: function(data) {
						$('#teacherTable tr').remove();
						$('#teacherTable').append('<tr><td id="header">Nachname</td><td id="header">Vorname</td></tr>');
						$.each(data, function(index, teacher) { 
							appendTeacher(teacher);
						})
					},
					error: function() {
						alert("Fehler!");
					},
					method: "POST",
					mimeType: "application/json"
				});
			}
			
			function appendTeacher(teacher){
				$('#teacherTable').append($('<tr id="' + teacher.key.id + '"><td>' + teacher.familyName + '</td><td>' + teacher.firstName + '</td></tr>'))
			}
			
	</script>
		<header>
			<nav id="doc_navlist">
				<ul>
					<li> </li>
					<li>
						<a href="./mylan">MyLAN</a>
					</li> 
					<li id="current">
						<a href="./teachers">Lehrer</a>
					</li> 
					<li>
						<a href="./classes">Klassen</a>
					</li> 
					<li>
						<a href="./pupils">Sch&uuml;ler</a>
					</li>
					<li>
						<a href="./maint">Verwalten</a>
					</li>
					<li> </li>
					<li id="justifier"> </li>
				</ul>
			</nav>
		</header>
		
		
		<div id="pagecontent">
			<div id="tablecontent">
				<div id="tablefilter">
					<select id="ddb_inst" onclick="filter()">
						<option value="" disabled selected hidden id="teachers_ddbFilter_inst">Nach Schule filtern</option>
					</select>
					<select id="ddb_grade" onclick="filter()">
						<option value="" disabled selected hidden id="teachers_ddbFilter_grade">Nach Stufe filtern</option>
					</select>
					<select id="ddb_class" onclick="filter()">
						<option value="" disabled selected hidden id="teachers_ddbFilter_class">Nach Klasse filtern</option>
					</select>
					<select id="ddb_pupil" onclick="filter()">
						<option value="" disabled selected hidden id="teachers_ddbFilter_pupil">Nach Schüler filtern</option>
					</select>
				</div>
				<div id="table">
					<table  id="teacherTable">
						<tr>
							<td id="header">Nachname</td>
							<td id="header">Vorname</td>
						</tr>
					</table>
				</div>
			</div>
			<div id="previewcontent">
				<div id="preview">
					<div id="picture">
						<img src="pictures/teacher_def.jpg"/>
					</div>
					<div id="info">
						<div>
							<label >Schule:</label>
							<input type="text" value="Schule" id="teachers_inpt_iName" readonly>
						</div>
						<div>
							<label>Vorname:</label>
							<input type="text" value="Vorname" id="teachers_inpt_fName" readonly>
						</div>
						<div>
							<label>Nachname:</label>
							<input type="text" value="Vorname" id="teachers_inpt_lName" readonly>
						</div>
					</div>
					<div id="teacher_classes">
						<label>Klassen:</label>
						<ul>
							<li>5a</li>
							<li>5a</li>
							<li>5a</li>
							<li>5a</li>
							<li>5a</li>
							<li>5a</li>
							<li>5a</li>
							<li>5a</li>
							<li>5a</li>
							<li>5a</li>
						</ul>
					</div>
				</div>
				
				<div id="notes_table">
					<span>
						<label>Erstellte Notizen:</label>
						<input type="button" value="Öffnen" id="btn_openNote" onclick="onclickTeacher_OpenNote()"/>
					</span>
					<div id="table">
						<table>
							<tr>
								<td id="header">Erfassungszeitpunkt</td>
								<td id="header">Schüler</td>
								<td id="header">Klasse</td>
							</tr>
							<tr><td>01.01.01</td><td>Fritz Fischer</td><td>1a</td></tr>
							<tr><td>01.01.01</td><td>Fritz Fischer</td><td>1a</td></tr>
							<tr><td>01.01.01</td><td>Fritz Fischer</td><td>1a</td></tr>
							<tr><td>01.01.01</td><td>Fritz Fischer</td><td>1a</td></tr>
							<tr><td>01.01.01</td><td>Fritz Fischer</td><td>1a</td></tr>
							<tr><td>01.01.01</td><td>Fritz Fischer</td><td>1a</td></tr>
							<tr><td>01.01.01</td><td>Fritz Fischer</td><td>1a</td></tr>
							<tr><td>01.01.01</td><td>Fritz Fischer</td><td>1a</td></tr>
							<tr><td>01.01.01</td><td>Fritz Fischer</td><td>1a</td></tr>
							<tr><td>01.01.01</td><td>Fritz Fischer</td><td>1a</td></tr>
							<tr><td>01.01.01</td><td>Fritz Fischer</td><td>1a</td></tr>
							<tr><td>01.01.01</td><td>Fritz Fischer</td><td>1a</td></tr>
							<tr><td>01.01.01</td><td>Fritz Fischer</td><td>1a</td></tr>
							<tr><td>01.01.01</td><td>Fritz Fischer</td><td>1a</td></tr>
							<tr><td>01.01.01</td><td>Fritz Fischer</td><td>1a</td></tr>
							<tr><td>01.01.01</td><td>Fritz Fischer</td><td>1a</td></tr>
							<tr><td>01.01.01</td><td>Fritz Fischer</td><td>1a</td></tr>
							<tr><td>01.01.01</td><td>Fritz Fischer</td><td>1a</td></tr>
							<tr><td>01.01.01</td><td>Fritz Fischer</td><td>1a</td></tr>
							<tr><td>01.01.01</td><td>Fritz Fischer</td><td>1a</td></tr>
							<tr><td>01.01.01</td><td>Fritz Fischer</td><td>1a</td></tr>
							<tr><td>01.01.01</td><td>Fritz Fischer</td><td>1a</td></tr>
							<tr><td>01.01.01</td><td>Fritz Fischer</td><td>1a</td></tr>
							<tr><td>01.01.01</td><td>Fritz Fischer</td><td>1a</td></tr>
							<tr><td>01.01.01</td><td>Fritz Fischer</td><td>1a</td></tr>
							<tr><td>01.01.01</td><td>Fritz Fischer</td><td>1a</td></tr>
							<tr><td>01.01.01</td><td>Fritz Fischer</td><td>1a</td></tr>
							<tr><td>01.01.01</td><td>Fritz Fischer</td><td>1a</td></tr>
							<tr><td>01.01.01</td><td>Fritz Fischer</td><td>1a</td></tr>
							<tr><td>01.01.01</td><td>Fritz Fischer</td><td>1a</td></tr>
							<tr><td>01.01.01</td><td>Fritz Fischer</td><td>1a</td></tr>
							<tr><td>01.01.01</td><td>Fritz Fischer</td><td>1a</td></tr>
							<tr><td>01.01.01</td><td>Fritz Fischer</td><td>1a</td></tr>
							<tr><td>01.01.01</td><td>Fritz Fischer</td><td>1a</td></tr>
						</table>
					</div>
					<label>Vorschau Notiz:</label>
					<div id="preview_noteContent">
						<textarea id="note_txtArea_content" readonly></textarea>
					</div>
				</div>
			
			</div>
		</div>
		
		
		<footer>
			<div id="footer_logoutbar">
				<p id="footer_txt_logininfo"></p>
				<a href='logout' id="footer_a_logout">> Abmelden &lt;</a>
			</div>
		</footer>
    </body>
</html>















