<html>
    <head>
        <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
        <title>
            LAN-Gymnasium online Klassenbuch
        </title>
         <link rel="stylesheet" href="style/login.css" type="text/css">
    </head>
    <body>
	<script src="javascript/script.js"></script>
	<script src="javascript/jquery-2.1.4.min.js"></script>
	<script>
		
		
		window.addEventListener("DOMContentLoaded", function(){
			getAllSchools();
		});
		
		function appendSchool(school){
			$('#login_ddb_inst').append($('<option value=\"'+ school.name +'\">'+ school.name +'</option>'));
		}
		
		function getAllSchools(){
			$.getJSON("/rest/school", function(data) {
				$("#login_ddb_inst option").remove();
				$('#login_ddb_inst').append($('<option value="" disabled selected hidden id="login_ddb_default">Schule wählen</option>'));
				$.each(data, function(index, school) {
					appendSchool(school);
				})
			})
		}
		
		
		function onclickLogin(form) {
			var school = form.login_ddb_inst.value;
			var fname = form.login_inpt_fname.value;
			var lname = form.login_inpt_lname.value;
			var passwd = form.login_inpt_passwd.value;
			var isTeacher = form.login_chkbx_isTeacher.checked;
			
			$.post("login", 
				{
					school: school,
					firstName: fname, 
					familyName: lname,
					password: passwd,
					isTeacher: isTeacher
				},
				function(data, status){
					
				});
			
// 			$.ajaxSetup({
// 			  contentType: "application/json; charset=utf-8"
// 			});
			
// 			$.ajax({
// 				url: "/rest/user",
// 				contentType: "application/json; charset=utf-8",
// 				data: JSON.stringify(school+"#"+fname+"#"+lname+"#"+passwd),

// 				method: "GET",
// 				mimeType: "application/json"
// 			});
			
// 			window.location.href="mylan.html";
		}
	</script>
		<header>
			<p id="header_txt_great"> WILLKOMMEN IM LAN-PORTAL! </p>
		</header>
        <div>
            <form id="login_frm">
				<p id="login_txt">Im LAN-Portal anmelden</p>
				
				<select type="institution" id="login_ddb_inst" tabindex ="1">
					<option value="" disabled selected hidden id="login_ddb_default">Schule wählen</option>
				</select>
				<input type="text" placeholder ="Vornamen eingeben" id="login_inpt_fname" name="firstName" tabindex ="2"/>
				<input type="text" placeholder="Nachnamen eingeben" tabindex ="3" name="familyName" id="login_inpt_lname"/>
				<input type="password" placeholder="Passwort eingeben" id="login_inpt_passwd" name="password" tabindex ="4"/>
				
				<input type="checkbox" name="isTeacher" id="login_chkbx_isTeacher" tabindex="5">Bin Lehrer
				
                <input type="button" value="Anmelden" id="login_bt" onclick="onclickLogin(this.form)"/>
            </form>
        </div>
		<footer>
			<div id="footer_logoutbar">
				<p id="footer_txt_logininfo"></p>
				<a href='logout' id="footer_a_logout">> Abmelden &lt;</a>
			</div>
		</footer>
    </body>
</html>